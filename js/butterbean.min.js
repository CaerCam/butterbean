!function(){if(!_.isUndefined(butterbean_data)){var e={managers:{},sections:{},controls:{}},t={managers:{},sections:{},controls:{}},n=wp.template("butterbean-nav"),a=Backbone.Model.extend({defaults:{name:"",type:"",sections:{},controls:{}}}),i=Backbone.Model.extend({defaults:{name:"",type:"",label:"",description:"",icon:"",manager:"",active:!1}}),r=Backbone.Model.extend({defaults:{name:"",type:"",label:"",description:"",icon:"",value:"",choices:{},attr:"",manager:"",section:"",setting:""}}),o=Backbone.Collection.extend({model:i}),s=Backbone.View.extend({tagName:"div",attributes:function(){return{id:"butterbean-manager-"+this.model.get("name"),"class":"butterbean-manager butterbean-manager-"+this.model.get("type")}},initialize:function(){var e=this.model.get("type");_.isUndefined(t.managers[e])&&(t.managers[e]=wp.template("butterbean-manager-"+e)),this.template=t.managers[e]},render:function(){return this.el.innerHTML=this.template(this.model.toJSON()),this},subview_render:function(){var t=new o;return _.each(this.model.get("sections"),function(e){t.add(new i(e))}),t.forEach(function(e,t){var n=new l({model:e}),a=new c({model:e});document.querySelector("#butterbean-ui-"+e.get("manager")+" .butterbean-nav").appendChild(n.render().el),document.querySelector("#butterbean-ui-"+e.get("manager")+" .butterbean-content").appendChild(a.render().el),e.set("active",0==t)},this),_.each(this.model.get("controls"),function(t){var n=new r(t),a=_.isUndefined(e.controls[t.type])?e.controls["default"]:e.controls[t.type],i=new a({model:n});document.getElementById("butterbean-"+n.get("manager")+"-section-"+n.get("section")).appendChild(i.render().el)}),this}}),c=Backbone.View.extend({tagName:"div",attributes:function(){return{id:"butterbean-"+this.model.get("manager")+"-section-"+this.model.get("name"),"class":"butterbean-section butterbean-section-"+this.model.get("type"),"aria-hidden":!this.model.get("active")}},initialize:function(){this.model.on("change",this.onchange,this);var e=this.model.get("type");_.isUndefined(t.sections[e])&&(t.sections[e]=wp.template("butterbean-section-"+e)),this.template=t.sections[e]},render:function(){return this.el.innerHTML=this.template(this.model.toJSON()),this},onchange:function(){this.el.setAttribute("aria-hidden",!this.model.get("active"))}}),l=Backbone.View.extend({template:n,tagName:"li",attributes:function(){return{"aria-selected":this.model.get("active")}},initialize:function(){this.model.on("change",this.render,this),this.model.on("change",this.onchange,this)},render:function(){return this.el.innerHTML=this.template(this.model.toJSON()),this},events:{"click a":"onselect"},onchange:function(){this.el.setAttribute("aria-selected",this.model.get("active"))},onselect:function(e){e.preventDefault(),_.each(this.model.collection.models,function(e){e.set("active",!1)},this),this.model.set("active",!0)}});e.controls.default=Backbone.View.extend({tagName:"div",attributes:function(){return{id:"butterbean-control-"+this.model.get("name"),"class":"butterbean-control butterbean-control-"+this.model.get("type")}},initialize:function(){var e=this.model.get("type");_.isUndefined(t.controls[e])&&(t.controls[e]=wp.template("butterbean-control-"+e)),this.template=t.controls[e],this.ready()},render:function(){return this.el.innerHTML=this.template(this.model.toJSON()),this},ready:function(){}}),e.controls.palette=e.controls.default.extend({events:{"change input":"onselect"},ready:function(){_.bindAll(this,"render"),this.model.bind("change",this.render)},onselect:function(){var e=document.querySelector("#"+this.el.id+" input:checked").getAttribute("value"),t=this.model.get("choices");_.each(t,function(t,n){t.selected=n===e}),this.model.set("choices",t).trigger("change",this.model)}}),_.each(butterbean_data.managers,function(e){var t=new a(e),n=new s({model:t});document.getElementById("butterbean-ui-"+t.get("name")).className+=" butterbean-ui",document.querySelector("#butterbean-ui-"+t.get("name")+" .inside").appendChild(n.render().el),n.subview_render()}),document.querySelector(".butterbean-ui .hndle").className+=" butterbean-title",document.querySelector(".butterbean-ui .butterbean-description").className+=" description"}}();